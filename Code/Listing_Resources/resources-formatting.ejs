```{=html}

<head>
  <meta charset="UTF-8">
  <title>Resources with Features:
    - Four categories filter with sorting by title and date updated - May 10th, 2025
    - Show more with starting at 5 rows of tiles and back-to-top - June 11th, 2025
    - Default sorting by ranking (ascending) then title (A-Z) called "No sorting" - Sept. 11th, 2025
  </title>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
</head>
<body>
  <div>
    <div class="main-container">
      <div class="sidebar-wrapper">
        <aside class="sidebar">
          <div class="sort-wrapper">
            <select id="sortOptions" class="form-control" style="width: 94%;">
              <option value="default" selected>No sorting</option>
              <option value="title-asc">Title A-Z</option>
              <option value="title-desc">Title Z-A</option>
              <option value="date-desc">Date Updated: Newest to Oldest</option>
              <option value="date-asc">Date Updated: Oldest to Newest</option>
            </select>
          </div>

          <!-- Affiliation filter -->
          <form id="categoryFilter1" class="form">
            <h5>Institutional Home</h5>
            <% if (items && items[0].items && items[0].items.length > 0) { %>
              <% const categories1 = new Set(); %>
              <% items[0].items.forEach(function(item) {
                   if (item.categories1) {
                     item.categories1.forEach(function(cat) {
                       categories1.add(cat);
                     });
                   }
                 }); %>
              <% categories1.forEach(function(category) { %>
                <div class="checkbox-container">
                  <input type="checkbox" name="category1" value="<%= encodeURIComponent(category) %>"
                         id="category1-<%= encodeURIComponent(category) %>">
                  <label for="category1-<%= encodeURIComponent(category) %>" style="margin-bottom: 0px;"><%= category %></label>
                </div>
              <% }); %>
            <% } %>
          </form>

          <br>

          <!-- Content Type filter -->
          <form id="categoryFilter2" class="form">
            <h5>Content Type</h5>
            <% if (items && items[0].items && items[0].items.length > 0) { %>
              <% const categories2 = new Set(); %>
              <% items[0].items.forEach(function(item) {
                   if (item.categories2) {
                     item.categories2.forEach(function(cat) {
                       categories2.add(cat);
                     });
                   }
                 }); %>
              <% categories2.forEach(function(category) { %>
                <div class="checkbox-container">
                  <input type="checkbox" name="category2" value="<%= encodeURIComponent(category) %>"
                         id="category2-<%= encodeURIComponent(category) %>">
                  <label for="category2-<%= encodeURIComponent(category) %>" style="margin-bottom: 0px;"><%= category %></label>
                </div>
              <% }); %>
            <% } %>
          </form>

          <br>

          <!-- Event Type filter -->
          <form id="categoryFilter3" class="form">
            <h5>Event Type</h5>
            <% if (items && items[0].items && items[0].items.length > 0) { %>
              <% const categories3 = new Set(); %>
              <% items[0].items.forEach(function(item) {
                   if (item.categories3) {
                     item.categories3.forEach(function(cat) {
                       categories3.add(cat);
                     });
                   }
                 }); %>
              <% categories3.forEach(function(category) { %>
                <div class="checkbox-container">
                  <input type="checkbox" name="category3" value="<%= encodeURIComponent(category) %>"
                         id="category3-<%= encodeURIComponent(category) %>">
                  <label for="category3-<%= encodeURIComponent(category) %>" style="margin-bottom: 0px;"><%= category %></label>
                </div>
              <% }); %>
            <% } %>
          </form>

          <br>

          <!-- Semester filter -->
          <form id="categoryFilter4" class="form">
            <h5>Semester Available</h5>
            <% if (items && items[0].items && items[0].items.length > 0) { %>
              <% const categories4 = new Set(); %>
              <% items[0].items.forEach(function(item) {
                   if (item.categories4) {
                     item.categories4.forEach(function(cat) {
                       if (cat !== 'N/A') {  // Exclude 'N/A' from appearing in filter
                         categories4.add(cat);
                       }
                     });
                   }
                 }); %>
              <% categories4.forEach(function(category) { %>
                <div class="checkbox-container">
                  <input type="checkbox" name="category4" value="<%= encodeURIComponent(category) %>"
                         id="category4-<%= encodeURIComponent(category) %>">
                  <label for="category4-<%= encodeURIComponent(category) %>" style="margin-bottom: 0px;"><%= category %></label>
                </div>
              <% }); %>
            <% } %>
          </form>
        </aside>
      </div>

      <div class="main-content">
        <div class="container" id="tilesContainer">
          <% let visibleTileCount = 0; %>
          <% items[0].items.forEach(function(item) {
               if (item.tiles && item.tiles.length > 0) {
                 item.tiles.forEach(function(tile) { %>
                   <div class="tile <%= (visibleTileCount < 9) ? '' : 'hidden' %>"
                        data-categories1="<%= item.categories1 ? item.categories1.map(cat => encodeURIComponent(cat)).join(' ') : '' %>"
                        data-categories2="<%= item.categories2 ? item.categories2.map(cat => encodeURIComponent(cat)).join(' ') : '' %>"
                        data-categories3="<%= item.categories3 ? item.categories3.map(cat => encodeURIComponent(cat)).join(' ') : '' %>"
                        data-categories4="<%= item.categories4 ? item.categories4.map(cat => encodeURIComponent(cat)).join(' ') : '' %>"
                        data-ranking="<%= tile.ranking %>"
                        data-title="<%= tile.title %>"
                        data-date="<%= tile['date-updated'] %>"
                        data-not-applicable="<%= item.categories4.includes('N/A') %>">
                     <div class="image-container" style="position: relative;">
                       <img src="<%= tile.image %>" class="image">
                       <% if (!item.categories4.includes('N/A')) { %>
                         <div class="semester-indicators">
                           <% if (item.categories4.includes('Fall')) { %>
                             <div class="semester-indicator">Fa</div>
                           <% } %>
                           <% if (item.categories4.includes('Spring')) { %>
                             <div class="semester-indicator">Sp</div>
                           <% } %>
                           <% if (item.categories4.includes('Summer')) { %>
                             <div class="semester-indicator">Su</div>
                           <% } %>
                           <% if (item.categories4.includes('Asynchronous')) { %>
                             <div class="semester-indicator">As</div>
                           <% } %>
                           <% if (item.categories4.includes('Varies')) { %>
                             <div class="semester-indicator">Va</div>
                           <% } %>
                         </div>
                       <% } %>
                     </div>
                     <h2 class="js-line-count"><%= tile.title %></h2>
                     <% if (tile.instructors && tile.instructors.length > 0) { %>
                       <p class="instructors">
                         <%= tile.instructors.map(function(instructor, index) {
                              return '<a href="' + instructor.href + '" target="_blank">' + instructor.text + '</a>' +
                                     (index < tile.instructors.length - 1 ? ', ' : '');
                            })
                            .join('') %>
                       </p>
                     <% } %>
                     <p class="description"><%= tile.description %></p>
                     <div class="card-header py-1 px-2 border-bottom bg-light">
                       <small class="card-text">
                         <% if (tile.site) { %>
                           &nbsp;
                           <a href="<%= tile.site %>" title="Main site" class="source-code" style="color: rgba(var(--bs-link-color-rgb), var(--bs-link-opacity, 1));">
                             <i class="bi-globe"></i></a>
                         <% } %>
                         <% if (tile.group) { %>
                           &nbsp;
                           <a href="<%= tile.group %>" title="Group site" class="source-code" style="color: rgba(var(--bs-link-color-rgb), var(--bs-link-opacity, 1));">
                             <i class="bi-people-fill"></i></a>
                         <% } %>
                         <% if (tile.course_site) { %>
                           &nbsp;
                           <a href="<%= tile.course_site %>" title="Course site" class="source-code" style="color: rgba(var(--bs-link-color-rgb), var(--bs-link-opacity, 1));">
                             <i class="bi-mortarboard"></i></a>
                         <% } %>
                         <% if (tile.github) { %>
                           &nbsp;
                           <a href="<%= tile.github %>" title="GitHub page" class="source-code"
                              style="color: rgba(var(--bs-link-color-rgb), var(--bs-link-opacity, 1));">
                             <i class="bi-github"></i></a>
                         <% } %>
                         <% if (tile.article) { %>
                           &nbsp;
                           <a href="<%= tile.article %>" title="View publication" class="source-code"
                              style="color: rgba(var(--bs-link-color-rgb), var(--bs-link-opacity, 1));">
                             <i class="bi-journal-text"></i></a>
                         <% } %>
                         <% if (tile.info) { %>
                           &nbsp;
                           <a href="<%= tile.info %>" title="Get more information" class="source-code"
                              style="color: rgba(var(--bs-link-color-rgb), var(--bs-link-opacity, 1));">
                             <i class="bi-info-circle"></i></a>
                         <% } %>
                         <% if (tile.topic) { %>
                           <p class="topic" style="margin-bottom: 5px;"><%= tile.topic %></p>
                         <% } else { %>
                           <p class="topic" style="display:none; margin-bottom: 5px;"></p>
                         <% } %>
                       </small>
                     </div>
                   </div>
                   <% visibleTileCount++ %>
                 <% });
               } else { %>
                 <p>No tiles found for this category.</p>
               <% }
             }); %>
        </div>
        <button id="showMoreBtn" class="btn btn-primary" style="display: block; margin: 20px auto;">Show More</button>
        <a id="quarto-back-to-top" title="Back to top" role="button" style="display: none;"><i class="bi bi-arrow-up"></i>Back to top</a>
      </div>
    </div>
  </div>

  <script>
    function parseDate(dateStr) {
      return new Date(dateStr);
    }

    function updateLineCounts() {
      document.querySelectorAll(".tile").forEach(function (tile) {
        const h2Element = tile.querySelector(".js-line-count");
        const lineHeight = parseFloat(getComputedStyle(h2Element).lineHeight);

        const linesInH2 = Math.ceil(h2Element.scrollHeight / lineHeight);

        const instructorElement = tile.querySelector('.instructors');
        const linesInInstructors = instructorElement ? Math.ceil(instructorElement.scrollHeight / lineHeight) : 0;

        const pElement = tile.querySelector("p.description");
        pElement.style.display = '-webkit-box';
        pElement.style.webkitBoxOrient = 'vertical';
        pElement.style.overflow = 'hidden';

        let clampValue = 10;

        clampValue -= Math.max(0, linesInH2 - 1);
        clampValue -= Math.max(0, linesInInstructors - 1);

        const topicElement = tile.querySelector('.topic');
        if (topicElement && topicElement.style.display !== 'none') {
          const linesInTopic = Math.ceil(topicElement.scrollHeight / lineHeight);
          clampValue -= Math.max(0, linesInTopic - 1);
        }

        if (clampValue < 1) clampValue = 1; // Ensure at least one line is available for the description

        pElement.style.webkitLineClamp = clampValue;
      });
    }

    document.addEventListener('DOMContentLoaded', function () {
      updateLineCounts();
      window.addEventListener('resize', updateLineCounts);

      const categoryFilter1 = document.getElementById('categoryFilter1');
      const categoryFilter2 = document.getElementById('categoryFilter2');
      const categoryFilter3 = document.getElementById('categoryFilter3');
      const categoryFilter4 = document.getElementById('categoryFilter4'); // Added new category filter
      const sortOptions = document.getElementById('sortOptions');
      const tilesContainer = document.getElementById('tilesContainer');
      const showMoreBtn = document.getElementById('showMoreBtn');
      const initialLoadCount = 9; // 3 rows of 3 tiles each
      const loadMoreCount = 3; // 1 row of 3 tiles

      let tiles = Array.from(tilesContainer.querySelectorAll('.tile'));
      let sortedTiles = [...tiles];  // Preserve original order for sorted tiles

      // Function to sort by default criteria: ranking then title
      function sortByDefault() {
        sortedTiles.forEach(tile => {
          const rankAttr = tile.getAttribute('data-ranking');
          if (rankAttr) {
            tile.dataset.numericRanking = parseInt(rankAttr, 10);
          }
        });

        sortedTiles.sort((a, b) => {
          const titleA = a.getAttribute('data-title').toLowerCase();
          const titleB = b.getAttribute('data-title').toLowerCase();
          const rankingA = a.dataset.numericRanking || 0;
          const rankingB = b.dataset.numericRanking || 0;

          if (rankingA !== rankingB) {
            return rankingA - rankingB;
          }
          return titleA.localeCompare(titleB);
        });

        sortedTiles.forEach(tile => {
          tilesContainer.appendChild(tile);
        });

        filterTiles(); // Apply the current filter on new sorted order
      }

      // Initialize the display with the initial tiles shown
      sortedTiles.slice(0, initialLoadCount).forEach(tile => tile.classList.remove('hidden'));

      showMoreBtn.addEventListener('click', function () {
        let hiddenTiles = sortedTiles.filter(tile => tile.classList.contains('hidden') && tile.classList.contains('filtered'));
        hiddenTiles.slice(0, loadMoreCount).forEach(tile => {
          tile.classList.remove('hidden');
          tile.style.display = 'block'; // Ensure display is set to block
        });
        updateLineCounts();
        if (hiddenTiles.length <= loadMoreCount) {
          showMoreBtn.style.display = 'none';
        }
      });

      function filterTiles() {
        const selectedCategories1 = Array.from(categoryFilter1.querySelectorAll('input[name="category1"]:checked')).map(input => decodeURIComponent(input.value));
        const selectedCategories2 = Array.from(categoryFilter2.querySelectorAll('input[name="category2"]:checked')).map(input => decodeURIComponent(input.value));
        const selectedCategories3 = Array.from(categoryFilter3.querySelectorAll('input[name="category3"]:checked')).map(input => decodeURIComponent(input.value));
        const selectedCategories4 = Array.from(categoryFilter4.querySelectorAll('input[name="category4"]:checked')).map(input => decodeURIComponent(input.value));

        let visibleTileCount = 0;

        sortedTiles.forEach(function(tile) {
          const categories1 = (tile.getAttribute('data-categories1') || '').split(' ').map(cat => decodeURIComponent(cat));
          const categories2 = (tile.getAttribute('data-categories2') || '').split(' ').map(cat => decodeURIComponent(cat));
          const categories3 = (tile.getAttribute('data-categories3') || '').split(' ').map(cat => decodeURIComponent(cat));
          const categories4 = (tile.getAttribute('data-categories4') || '').split(' ').map(cat => decodeURIComponent(cat));
          const isNotApplicable = tile.getAttribute('data-not-applicable') === 'true';

          const matchesCategory1 = selectedCategories1.length === 0 || selectedCategories1.some(cat => categories1.includes(cat));
          const matchesCategory2 = selectedCategories2.length === 0 || selectedCategories2.some(cat => categories2.includes(cat));
          const matchesCategory3 = selectedCategories3.length === 0 || selectedCategories3.some(cat => categories3.includes(cat));

          let matchesCategory4 = true;
          if (selectedCategories4.length > 0) {
            // If there's a filter on categories4, tiles with N/A should not be matched
            matchesCategory4 = isNotApplicable ? false : selectedCategories4.some(cat => categories4.includes(cat));
          }

          if (matchesCategory1 && matchesCategory2 && matchesCategory3 && matchesCategory4) {
            tile.classList.add('filtered');
            if (visibleTileCount < initialLoadCount) {
              tile.classList.remove('hidden');
              tile.style.display = 'block'; // Ensure display is set to block
              visibleTileCount++;
            } else {
              tile.classList.add('hidden');
              tile.style.display = 'none'; // Hide others
            }
          } else {
            tile.classList.remove('filtered');
            tile.classList.add('hidden');
            tile.style.display = 'none'; // Hide if it doesn't match the filter
          }
        });

        updateLineCounts();

        if (sortedTiles.filter(tile => tile.classList.contains('hidden')).length === 0) {
          showMoreBtn.style.display = 'none';
        } else {
          showMoreBtn.style.display = 'block';
        }
      }

      function sortTiles() {
        const sortValue = sortOptions.value;

        sortedTiles.sort((a, b) => {
          const titleA = a.getAttribute('data-title').toLowerCase();
          const titleB = b.getAttribute('data-title').toLowerCase();
          const dateA = parseDate(a.getAttribute('data-date'));
          const dateB = parseDate(b.getAttribute('data-date'));
          const rankingA = a.dataset.numericRanking || 0;
          const rankingB = b.dataset.numericRanking || 0;

          if (sortValue === 'title-asc') {
            return titleA.localeCompare(titleB);
          } else if (sortValue === 'title-desc') {
            return titleB.localeCompare(titleA);
          } else if (sortValue === 'date-asc') {
            return dateA - dateB;
          } else if (sortValue === 'date-desc') {
            return dateB - dateA;
          } else if (sortValue === 'default') {
            if (rankingA !== rankingB) {
              return rankingA - rankingB;
            }
            return titleA.localeCompare(titleB);
          }
  
          return 0;
        });
  
        // Move tiles in the container based on sorted order
        sortedTiles.forEach(tile => {
          tilesContainer.appendChild(tile);
        });
  
        filterTiles(); // Apply the current filter on new sorted order
      }
  
      categoryFilter1.addEventListener('change', filterTiles);
      categoryFilter2.addEventListener('change', filterTiles);
      categoryFilter3.addEventListener('change', filterTiles);
      categoryFilter4.addEventListener('change', filterTiles); // Added event listener for new category
      sortOptions.addEventListener('change', sortTiles);
  
      filterTiles(); // Apply filters initially after DOM is ready
  
      // Initial sort by default (ranking then title)
      sortByDefault();
    });
  </script>
</body>

```

